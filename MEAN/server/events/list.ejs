<%- include('./partials/header.ejs') %>
<%- include('./partials/main_nav.ejs') %>

<div class="container mt-4">
    <!-- Page Title + Create Button -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h1 class="display-5">Events</h1>
        <a href="/events/create" class="btn btn-success">
            <i class="fas fa-plus-circle"></i> Add Event
        </a>
    </div>
    <!-- Search Bar + Sort Options -->
    <div class="mb-3 d-flex justify-content-between">
        <form class="d-flex" method="GET" action="/events/list">
            <input type="text" name="search" placeholder="Search events..." class="form-control me-2">
            <button class="btn btn-primary">Search</button>
        </form>

        <div>
            <a href="/events/list?sort=name" class="btn btn-outline-secondary btn-sm">Sort by Name</a>
            <a href="/events/list?sort=date" class="btn btn-outline-secondary btn-sm">Sort by Date</a>
            <a href="/events/list?sort=type" class="btn btn-outline-secondary btn-sm">Sort by Type</a>
        </div>
    </div>
    <!-- When no events exist -->
    <% if (EventList.length === 0) { %>
        <div class="alert alert-info text-center">
            No events found. Click <strong>Add Event</strong> to create your first one!
        </div>
    <% } %>
    <!-- Event Cards -->
    <div class="row">
        <% EventList.forEach(event => { %>
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm border-0" style="border-radius: 12px;">
                    <div class="card-body">

                        <!-- Event Name -->
                        <h4><%= event.name %></h4>

                        <!-- Event Type Badge -->
                        <span class="badge 
                            <% if (event.type === 'Birthday') { %> bg-pink <% } %>
                            <% if (event.type === 'Meeting') { %> bg-info <% } %>
                            <% if (event.type === 'Holiday') { %> bg-success <% } %>
                            <% if (event.type === 'School') { %> bg-primary <% } %>
                        ">
                            <%= event.type %>
                        </span>

                        <hr>

                        <!-- Date -->
                        <p><i class="far fa-calendar-alt"></i>
                            <strong>
                                <%= new Date(event.date).toLocaleDateString('en-US', { 
                                    month:'short', day:'numeric', year:'numeric' 
                                }) %>
                            </strong>
                        </p>

                        <!-- Time -->
                        <p><i class="far fa-clock"></i>
                            <%= event.time %>
                        </p>

                        <!-- Location -->
                        <p><i class="fas fa-map-marker-alt"></i>
                            <%= event.location %>
                        </p>

                        <!-- Edit + Delete Buttons -->
                        <div class="d-flex justify-content-between mt-3">
                            <a href="/events/edit/<%= event.id %>" class="btn btn-primary btn-sm">
                                <i class="fas fa-pencil-alt"></i> Edit
                            </a>
                            <a href="/events/delete/<%= event.id %>" class="btn btn-danger btn-sm">
                                <i class="fas fa-trash-alt"></i> Delete
                            </a>
                        </div>

                    </div>
                </div>
            </div>
        <% }) %>
    </div>

</div>
<%- include('./partials/footer.ejs') %>